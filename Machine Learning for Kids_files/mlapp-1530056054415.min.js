var AUTH0_CLIENT_ID="UCFQIBMNFoUk5e19SDujYKTYC463r7rI",AUTH0_DOMAIN="ml-for-kids.auth0.com",AUTH0_CALLBACK_URL=window.location.href,AUTH0_AUDIENCE="https://machinelearningforkids.co.uk/users",REQUESTED_SCOPES="openid email write:training";!function(){function e(e,t,n){(e.authService=t).setupAuth(),n.checkAuthOnRefresh(),n.redirectWhenUnauthenticated()}angular.module("app").run(e),e.$inject=["$rootScope","authService","authManager"]}(),function(){function e(e,t,n){var r=this;r.authService=e,r.orderBy="supervisors[0].created",r.filters={managed:"all",credentials:"all",demo:"all",active:"all",ibm:"all",dale:"all"},r.filter=function(e){var t=!0;return t&&"all"!==r.filters.managed&&("yes"===r.filters.managed?t=e.is_managed:"no"===r.filters.managed&&(t=!e.is_managed)),t&&"all"!==r.filters.credentials&&("none"===r.filters.credentials?t=0===e.credentials.total:"setup"===r.filters.credentials&&(t=0<e.credentials.total)),t&&"all"!==r.filters.demo&&("demo"===r.filters.demo?t="demo"===e.id:"exclude"===r.filters.demo&&(t="demo"!==e.id)),t&&"all"!==r.filters.active&&("2018"===r.filters.active?t=e.supervisors[0].last_login&&new Date(e.supervisors[0].last_login)>new Date("2018-01-01"):"multiple"===r.filters.active?t=1<e.supervisors[0].logins_count:"once"===r.filters.active?t=0<e.supervisors[0].logins_count:"never"===r.filters.active&&(t=0===e.supervisors[0].logins_count)),t&&"all"!==r.filters.ibm&&("only"===r.filters.ibm?t=0<e.supervisors[0].email.indexOf("ibm.com"):"exclude"===r.filters.ibm&&(t=e.supervisors[0].email.indexOf("ibm.com")<=0)),t&&"all"!==r.filters.dale&&"exclude"===r.filters.dale&&(t="dale"!==e.supervisors[0].username&&"demo"!==e.supervisors[0].username&&"dalelane"!==e.supervisors[0].username),t},r.createManagedTenant=function(){console.log(r.newtenant)},e.getProfileDeferred().then(function(e){"siteadmin"===(r.profile=e).role&&t.getClassesList(e).then(function(e){r.tenants=e})})}angular.module("app").controller("AdminController",e),e.$inject=["authService","usersService","$stateParams"]}(),function(){function e(a,o,e,t,i,c,l){var n="session-users",u=this;i.isTeacher=!1,i.isAuthenticated=!1,function(){try{window.localStorageObj=window.localStorage||{}}catch(e){window.localStorageObj={}}if("object"==typeof window.localStorageObj)try{window.localStorageObj.setItem("confirmLocalStorage",1),window.localStorageObj.removeItem("confirmLocalStorage")}catch(e){window._tempLocalStorage={},window.localStorageObj.setItem=function(e,t){window._tempLocalStorage[e]=t},window.localStorageObj.getItem=function(e){return window._tempLocalStorage[e]},window.localStorageObj.removeItem=function(e){delete window._tempLocalStorage[e]}}}();var r=window.localStorageObj.getItem("profile"),s=null;r&&(s=JSON.parse(r));var d=e.defer();if(s){var h=JSON.parse(window.localStorageObj.getItem("expires_at"));(new Date).getTime()<h?(d.resolve(s),i.isTeacher="supervisor"===s.role,i.isAuthenticated=!0,Raven&&(Raven.setUserContext({email:s.email,username:s.user_id}),Raven.setExtraContext({role:s.role,tenant:s.tenant}))):m()}function p(){d=e.defer(),window.localStorageObj.removeItem("access_token"),window.localStorageObj.removeItem("id_token"),window.localStorageObj.removeItem("expires_at"),window.localStorageObj.removeItem("scopes"),window.localStorageObj.removeItem("profile"),o.unauthenticate(),s=null,i.isTeacher=!1,i.isAuthenticated=!1}function m(){var e;s&&s.tenant===n?(e=s.user_id,t.delete("/api/classes/"+n+"/sessionusers/"+e).catch(function(e){console.log(e)})).then(function(){p()}):p()}return{login:function(){a.show({languageDictionary:{title:"Log in to ML for Kids"}})},reset:function(){a.show({languageDictionary:{title:"Forgot your password?"},allowForgotPassword:!0,allowLogin:!1,initialScreen:"forgotPassword"})},logout:m,setupAuth:function(){a.interceptHash(),a.on("authenticated",function(e){var t,n,r;e&&e.accessToken&&e.idToken&&(t=e,n=JSON.stringify(1e3*t.expiresIn+(new Date).getTime()),r=t.scope||REQUESTED_SCOPES||"",window.localStorageObj.setItem("access_token",t.accessToken),window.localStorageObj.setItem("id_token",t.idToken),window.localStorageObj.setItem("expires_at",n),window.localStorageObj.setItem("scopes",JSON.stringify(r)),o.authenticate(),a.getUserInfo(e.accessToken,function(e,t){if(e)return console.log("lock auth failure"),console.log(e),m();var n,r,a,o,s;u.profile=(r=(n=t)["https://machinelearningforkids.co.uk/api/tenant"],a=n["https://machinelearningforkids.co.uk/api/role"],o=n.sub,n.tenant=r,n.role=a,n.user_id=o,delete n["https://machinelearningforkids.co.uk/api/tenant"],delete n["https://machinelearningforkids.co.uk/api/role"],delete n.sub,delete n.picture,n),s=u.profile,window.localStorageObj.setItem("profile",JSON.stringify(s)),d.resolve(s),i.isTeacher="supervisor"===s.role,i.isAuthenticated=!0,l(function(){c.go("welcome")})}))}),a.on("authorization_error",function(e){e&&e.errorDescription&&"Please verify your email to activate your class account"===e.errorDescription&&alert("Please verify your email to activate your class account\n\nWhen you created your account, you should have been sent an email to verify your address. \nClicking on the link in that email will activate your class account.\n\nPlease click on the Help tab for more info")}),a.on("unrecoverable_error",function(e){return console.log("lock unrecoverable error"),console.log(e),m(),window.location.reload(!0)})},getProfileDeferred:function(){return d.promise},isAuthenticated:function(){if(s){var e=JSON.parse(window.localStorageObj.getItem("expires_at")),t=(new Date).getTime()<e;return t||m(),t}return!1},createSessionUser:function(){return t.post("/api/sessionusers").then(function(e){var t=e.data;return function(e){m(),window.localStorageObj.setItem("access_token",e.token),window.localStorageObj.setItem("id_token",e.jwt);var t=JSON.stringify(new Date(e.sessionExpiry).getTime());window.localStorageObj.setItem("expires_at",t),window.localStorageObj.setItem("scopes","openid email"),s={tenant:n,role:"student",user_id:e.id},window.localStorageObj.setItem("profile",JSON.stringify(s)),d.resolve(s),i.isAuthenticated=!0,i.isTeacher=!1}(t),t})}}}angular.module("app").service("authService",e),e.$inject=["lock","authManager","$q","$http","$rootScope","$state","$timeout"]}(),function(){function e(t,n,r,a,o,s){var i=this;i.authService=t,i.loginstate="login",function(){var e=n.search();if(e&&e.tab)switch(e.tab){case"login":case"reset":case"signup":case"newstudent":case"whyregister":i.loginstate=e.tab}}(),i.sendEmail=function(){window.location="mailto:dale.lane@uk.ibm.com?subject=New%20MLforKids%20class%20account&body=___PLEASE%20FILL%20IN%20THIS%20TEMPLATE___%0A%0APlease%20can%20you%20setup%20a%20new%20class%20account%20for%20my%20group.%20%0A%0AI%20need%20it%20from%20___THIS%20DATE___%20to%20___THAT%20DATE___%20for%20my%20group%20of%20___THIS%20MANY___%20students.%20%0A%0AI%20run%20___DESCRIPTION%20OF%20CODING%20GROUP%20AND%20THE%20STUDENTS%20I%20WORK%20WITH___.%0A%0AThanks%20very%20much!%0A%0A___WHO%20I%20AM___"},i.startTryItNowSession=function(e){a.failure=null,t.createSessionUser().then(function(e){o(function(){s.go("projects")})}).catch(function(e){var t=e.data;a.failure={message:function(e){if(e&&e.error)return"Class full"===e.error?"There are too many people currently using this feature. Sorry, but I'm limiting numbers for now. Please try later - or create yourself an account and log on now!":e.error;if(e&&e.message)return e.message;return"Unknown error"}(t),status:e.status},o(function(){var e=document.getElementById("sessionuserfailure");r.duScrollToElementAnimated(angular.element(e))},0)})}}angular.module("app").controller("LoginController",e),e.$inject=["authService","$location","$document","$scope","$timeout","$state"]}(),angular.module("app").directive("mlcanvas",function(){return{template:'<div class="mlcanvas"><canvas width="500" height="300"    ng-mousedown="handleMouseDown($event)"   ng-mousemove="handleMouseMove($event)"    ></canvas><div class="canvastools">    <div class="toolslabel">Tools</div>    <div class="btn-group" data-toggle="buttons">        <label class="btn btn-default" ng-class="{ \'active\' : canvastool === \'tooldraw\' }">            <input type="radio" value="tooldraw" name="drawtooloptions" ng-model="canvastool"> Draw        </label>        <label class="btn btn-default" ng-class="{ \'active\' : canvastool === \'toolerase\' }">            <input type="radio" value="toolerase" name="drawtooloptions" ng-model="canvastool"> Erase        </label>    </div>    <div class="btn btn-default" ng-click="reset()">Reset</div> </div></div>',restrict:"E",link:function(n,e,t,r,a){n.canvastool="tooldraw";var o=0,s=0,i=0,c=0;n.canvas=e.find("canvas")[0];var l=n.canvas.getContext("2d");n.handleMouseDown=function(e){i=o=e.offsetX,c=s=e.offsetY},n.handleMouseMove=function(e){var t;o=e.offsetX,s=e.offsetY,(void 0!==(t=e).buttons?1===t.buttons:1===t.which)&&(l.beginPath(),l.globalCompositeOperation="source-over","tooldraw"==n.canvastool?(l.strokeStyle="black",l.lineWidth=5):(l.strokeStyle="white",l.lineWidth=20),l.moveTo(i,c),l.lineTo(o,s),l.lineJoin=l.lineCap="round",l.stroke()),i=o,c=s},n.reset=function(){l.fillStyle="rgb(255,255,255)",l.fillRect(0,0,500,300)},n.reset()}}}),function(){function e(e,t,n,r){var a=this;a.authService=e,r.projectId=n.projectId,r.userId=n.userId,e.getProfileDeferred().then(function(e){return a.profile=e,t.getProject(r.projectId,r.userId,e.tenant)}).then(function(e){r.project=e}).catch(function(e){r.failure={message:e.data.error,status:e.status}})}angular.module("app").controller("ProjectController",e),e.$inject=["authService","projectsService","$stateParams","$scope"]}(),function(){function e(e,s,a,t,i,c,l,o,n,r,u){var d=this;d.authService=e;var h=18e4,p={code:"ERR",message:"Something went wrong",incidences:0,firstseen:(new Date).getTime()};function m(e){var t=(new Date).getTime()-h,n=!!e.code&&e.code===p.code,r=!e.code&&e.message===p.message,a=p.firstseen>t;if((n||r)&&a?p.incidences+=1:p={code:e.code,message:e.message,incidences:1,firstseen:(new Date).getTime()},3<p.incidences){var o=p.code;l.show({controller:["$scope",function(e){e.code=o,e.hide=function(){l.hide()}}],templateUrl:"static/components-"+i.VERSION+"/models/errordetail.tmpl.html"}).then(function(){},function(){}),p={code:"ERR",message:"Something went wrong",incidences:0,firstseen:(new Date).getTime()}}}var f=1;function g(e,t,n){n||(n={});var r=f++,a={code:n.code,alertid:r,message:n.message||n.error||"Unknown error",status:t};return d[e].push(a),m(a),r}function w(){return(e=c.models)&&0<e.length&&!e.some(function(e){return"Training"!==e.status})?"training":(t=c.models)&&0<t.length&&!t.some(function(e){return"Available"!==e.status})?"ready":0===c.models.length?"idle":"error";var e,t}d.errors=[],d.warnings=[],d.dismissAlert=function(e,t){d[e].splice(t,1)},c.loading=!0,c.status="unknown",c.projectId=i.projectId,c.userId=i.userId,c.owner=!0,c.minimumExamples="five",c.testformData={},c.quizQuestion=t.getQuestion(),e.getProfileDeferred().then(function(e){return d.profile=e,r.all({project:s.getProject(c.projectId,c.userId,d.profile.tenant),labels:s.getLabels(c.projectId,c.userId,d.profile.tenant),models:a.getModels(c.projectId,c.userId,d.profile.tenant)})}).then(function(e){var n,r,a,o,t;if(c.project=e.project,c.owner=d.profile.user_id===c.project.userid,"images"===e.project.type&&(c.minimumExamples="ten"),c.models=e.models,c.projectSummary=function(){if(0<c.project.labels.length){var e="";switch(c.project.labels.length){case 1:e=c.project.labels[0];break;case 2:e=c.project.labels[0]+" or "+c.project.labels[1];break;case 3:e=c.project.labels[0]+", "+c.project.labels[1]+" or "+c.project.labels[2];break;default:e=c.project.labels[0]+", "+c.project.labels[1]+" or "+(c.project.labels.length-2)+" other classes"}return e}}(),n=e.labels,r=!0,a=0,o="images"===c.project.type?10:5,t=Object.keys(n),c.trainingcounts=t.map(function(e){var t=n[e];return 0<t&&(r=!1),t<o&&(a+=1),{label:e,count:t}}),r?c.trainingdatastatus="no_data":1<a||a===t.length||t.length<2?c.trainingdatastatus="insufficient_data":c.trainingdatastatus="data",c.status=w(),"numbers"===c.project.type)return s.getFields(c.projectId,c.userId,d.profile.tenant)}).then(function(e){c.project.fields=e,c.loading=!1}).catch(function(e){k("errors"+g("errors",e.status,e.data))});var v=null;function b(){v&&(n.cancel(v),v=null)}function y(){v||(v=n(function(){a.getModels(c.projectId,c.userId,d.profile.tenant).then(function(e){c.models=e,c.status=w()}).then(function(){"training"!==c.status&&b()})},3e4))}function k(t){o(function(){var e=document.getElementById(t);u.duScrollToElementAnimated(angular.element(e))},0)}d.checkQuizAnswers=function(e){c.answered=!0,c.answerCorrect=!e.answers.some(function(e){return e.selected!==e.correct}),!1===c.answerCorrect&&e.answers.forEach(function(e){e.selected=e.correct})},d.nextQuizQuestion=function(){c.answered=!1;var e=c.quizQuestion;c.quizQuestion=t.getQuestion(),!1===c.answerCorrect&&t.restoreQuestion(e)},d.createModel=function(e,t){c.submittingTrainingRequest=!0,a.newModel(t.id,c.userId,d.profile.tenant).then(function(e){c.models=[e],c.status=w(),c.submittingTrainingRequest=!1,y()}).catch(function(e){c.submittingTrainingRequest=!1,k("errors"+g("errors",e.status,e.data))})},d.testModel=function(e,t,n){var r={type:n.type};"text"===n.type?r.text=c.testformData.testquestion:"images"===n.type?r.image=c.testformData.testimageurl:"numbers"===n.type&&(r.numbers=n.fields.map(function(e){return"number"===e.type?parseFloat(c.testformData[e.name]):c.testformData[e.name]})),c.testoutput="please wait...",c.testoutput_explanation="",a.testModel(n.id,n.type,c.userId,d.profile.tenant,c.models[0].classifierid,c.models[0].credentialsid,r).then(function(e){e&&0<e.length?(c.testoutput=e[0].class_name,c.testoutput_explanation="with "+Math.round(e[0].confidence)+"% confidence"):(c.testoutput="Unknown",c.testoutput_explanation="Test value could not be recognised")}).catch(function(e){k("errors"+g("errors",e.status,e.data))})},d.deleteModel=function(e,t,n){c.submittingDeleteRequest=!0;var r=n.classifierid;a.deleteModel(t.id,c.userId,d.profile.tenant,r).then(function(){c.models=c.models.filter(function(e){return e.classifierid!==r}),c.status=w(),"training"===c.status?y():b(),c.submittingDeleteRequest=!1}).catch(function(e){c.submittingDeleteRequest=!1,k("errors"+g("errors",e.status,e.data))})},d.useWebcam=function(e,t){c.testformData.testimageurl="",l.show({controller:["$scope",function(n){function r(e){(n.webcamerror=e)&&e.message&&("NotAllowedError"===e.name?n.webcamerrordetail="Not allowed to use the web-cam":n.webcamerrordetail=e.message)}n.channel={},n.webcamerror=!1,n.webcamInitComplete=!1,n.webcamCanvas=null,n.hide=function(){l.hide()},n.cancel=function(){l.cancel()},n.confirm=function(){l.hide(function(){var e=document.createElement("canvas");e.width=n.channel.video.width,e.height=n.channel.video.height,e.getContext("2d").drawImage(n.channel.video,0,0,n.channel.video.width,n.channel.video.height);var t=e.toDataURL("image/jpeg");return t.substr(t.indexOf(",")+1)}())},n.onWebcamSuccess=function(){n.$apply(function(){n.webcamInitComplete=!0})},n.onWebcamError=function(t){n.webcamInitComplete=!0;try{n.$apply(function(){r(t)})}catch(e){o(function(){r(t)},0,!1)}}}],templateUrl:"static/components-"+i.VERSION+"/models/webcam.tmpl.html",targetEvent:e,clickOutsideToClose:!0}).then(function(e){c.testoutput="please wait...",c.testoutput_explanation="",a.testModel(c.project.id,c.project.type,c.userId,d.profile.tenant,c.models[0].classifierid,c.models[0].credentialsid,{type:c.project.type,data:e}).then(function(e){e&&0<e.length?(c.testoutput=e[0].class_name,c.testoutput_explanation="with "+Math.round(e[0].confidence)+"% confidence"):(c.testoutput="Unknown",c.testoutput_explanation="Test value could not be recognised")}).catch(function(e){k("errors"+g("errors",e.status,e.data))})},function(){})},d.useCanvas=function(e){c.testformData.testimageurl="",l.show({controller:["$scope",function(n){n.hide=function(){l.hide()},n.cancel=function(){l.cancel()},n.confirm=function(){var e=n.canvas.toDataURL("image/jpeg"),t=e.substr(e.indexOf(",")+1);l.hide(t)}}],templateUrl:"static/components-"+i.VERSION+"/models/canvas.tmpl.html",targetEvent:e,clickOutsideToClose:!0}).then(function(e){c.testoutput="please wait...",c.testoutput_explanation="",a.testModel(c.project.id,c.project.type,c.userId,d.profile.tenant,c.models[0].classifierid,c.models[0].credentialsid,{type:c.project.type,data:e}).then(function(e){e&&0<e.length?(c.testoutput=e[0].class_name,c.testoutput_explanation="with "+Math.round(e[0].confidence)+"% confidence"):(c.testoutput="Unknown",c.testoutput_explanation="Test value could not be recognised")}).catch(function(e){k("errors"+g("errors",e.status,e.data))})},function(){})},c.$on("$destroy",b)}angular.module("app").controller("ModelsController",e),e.$inject=["authService","projectsService","trainingService","quizService","$stateParams","$scope","$mdDialog","$timeout","$interval","$q","$document"]}(),function(){function e(e,t,n,r){var a=this;a.authService=e,a.creating=!1,a.fields=[],a.focused=r.isTeacher?"crowdsourced":"name";var o=1;function s(e,t,n){n||(n={}),n&&403===t&&"Support for images projects is not enabled for your class"===n.error&&"session-users"===a.profile.tenant&&(n.message='You can\'t train machine learning models to recognise images with "Try it now". You will be able to create images projects if you login with a regular account. See the "Help" page for more details about the differences between creating an account and using "Try it now".'),a[e].push({alertid:o++,message:n.message||n.error||"Unknown error",status:t})}a.errors=[],a.warnings=[],a.dismissAlert=function(e,t){a[e].splice(t,1)};var i=1,c=9;e.getProfileDeferred().then(function(e){a.profile=e}).catch(function(e){s("errors",e.status,e.data)});var l=/^[^0-9\-.,][^,]*$/;a.isInvalid=function(e){if("numbers"===e){if(a.fields.length<1||10<a.fields.length)return!0;for(var t=0;t<a.fields.length;t++)if("multichoice"===a.fields[t].type){if(a.fields[t].choices.length<2||5<a.fields[t].choices.length)return!0;if(a.fields[t].choices.some(function(e){return!1===l.test(e)||e.length>c||e.length<i}))return!0}}return!1},a.addFieldChoice=function(e,t){if(e){var n=e.trim();if(0<n.length&&n.length<=c&&-1===t.choices.indexOf(n))return t.choices.push(n),!0}return!1},a.confirm=function(e){a.creating=!0,"numbers"!==e.type&&delete e.fields,t.createProject(e,a.profile.user_id,a.profile.tenant).then(function(e){n.go("projects")}).catch(function(e){s("errors",e.status,e.data),a.creating=!1})}}angular.module("app").controller("NewProjectController",e),e.$inject=["authService","projectsService","$state","$rootScope"]}(),function(){function e(e,r,a){var o=this;o.authService=e;var s=1;function i(e,t,n){n||(n={}),o[e].push({alertid:s++,message:n.message||n.error||"Unknown error",status:t})}function c(e){r.getProjects(e).then(function(e){o.projects=e;for(var t=0;t<o.projects.length;t++){var n=o.projects[t];if(0<n.labels.length){var r="";switch(n.labels.length){case 1:r=n.labels[0];break;case 2:r=n.labels[0]+" or "+n.labels[1];break;case 3:r=n.labels[0]+", "+n.labels[1]+" or "+n.labels[2];break;default:r=n.labels[0]+", "+n.labels[1]+" or "+(n.labels.length-2)+" other classes"}n.labelsSummary=r}}}).catch(function(e){i("errors",e.status,e.data)})}o.errors=[],o.warnings=[],o.dismissAlert=function(e,t){o[e].splice(t,1)},e.getProfileDeferred().then(function(e){c(o.profile=e)}).catch(function(e){i("errors",e.status,e.data)}),o.deleteProject=function(e,t){var n=a.confirm().title("Are you sure?").textContent("Do you want to delete "+t.name+"? (This cannot be undone)").ariaLabel("Confirm").targetEvent(e).ok("Yes").cancel("No");a.show(n).then(function(){t.isPlaceholder=!0,r.deleteProject(t,o.profile.user_id,o.profile.tenant).then(function(){var e=function(e){for(var t=o.projects.length,n=0;n<t;n++)if(o.projects[n].id===e)return n;return-1}(t.id);-1!==e?o.projects.splice(e,1):c(o.profile)}).catch(function(e){i("errors",e.status,e.data)})},function(){})},o.displayCrowdSourcedInfo=function(e){e.stopPropagation(),e.preventDefault(),a.show(a.alert().clickOutsideToClose(!0).title("Crowd-sourced project").textContent("This is a whole-class project. All the students in your class are able to access it and contribute training data to it.").ariaLabel("Crowd-sourced project").ok("Got it!").targetEvent(e))}}angular.module("app").controller("ProjectsController",e),e.$inject=["authService","projectsService","$mdDialog"]}(),function(){function e(e,a){return{getProject:function(e,t,n){return a.get("/api/classes/"+n+"/students/"+t+"/projects/"+e).then(function(e){return e.data})},getProjects:function(e){return a.get("/api/classes/"+e.tenant+"/students/"+e.user_id+"/projects").then(function(e){return e.data})},getClassProjects:function(e){return a.get("/api/classes/"+e.tenant+"/projects").then(function(e){return e.data})},deleteProject:function(e,t,n){return a.delete("/api/classes/"+n+"/students/"+t+"/projects/"+e.id)},createProject:function(e,t,n){return a.post("/api/classes/"+n+"/students/"+t+"/projects",e).then(function(e){return e.data})},getFields:function(e,t,n){return a.get("/api/classes/"+n+"/students/"+t+"/projects/"+e+"/fields").then(function(e){return e.data})},getLabels:function(e,t,n){return a.get("/api/classes/"+n+"/students/"+t+"/projects/"+e+"/labels").then(function(e){return e.data})},addLabelToProject:function(e,t,n,r){return a.patch("/api/classes/"+n+"/students/"+t+"/projects/"+e,[{op:"add",path:"/labels",value:r}]).then(function(e){return e.data})},removeLabelFromProject:function(e,t,n,r){return a.patch("/api/classes/"+n+"/students/"+t+"/projects/"+e,[{op:"remove",path:"/labels",value:r}]).then(function(e){return e.data})}}}angular.module("app").service("projectsService",e),e.$inject=["$q","$http"]}(),function(){function e(){var r=[{question:"In general, what will help machines to learn better?",attempted:!1,answers:[{text:"More examples",correct:!0},{text:"Fewer examples",correct:!1}],notes:["That isn't the only factor that has an effect. But in general, the more examples it has to learn from, the better."]},{question:"Which of these would probably be best for training a computer to recognise a photo of an apple?",attempted:!1,answers:[{text:"Photos of dogs",correct:!1},{text:"Varied photos of different types of apples in different places",correct:!0},{text:"Identical photos of an apple",correct:!1},{text:"Very, very similar photos of the same apple in the same place",correct:!1}],notes:["The more varied the examples you can collect, the more the system can learn about how to recognise different pictures of an apple.","If every example you give it is the same apple on the same brown wooden table, it might learn that something is only an apple if it's on a brown wooden table."]},{question:"Which of these would be a good use of machine learning?",attempted:!1,answers:[{text:"Adding big numbers together",correct:!1},{text:"Storing and retrieving customer records",correct:!1},{text:"Recognising if an email is spam",correct:!0},{text:"Counting the number of times a button is pressed",correct:!1}],notes:["Spam filters are a good example of machine learning.","With enough examples of legitimate emails, and enough examples of spam emails, a computer can start to learn how to recognise a spam email - without someone needing to work out a set of rules first."]},{question:"Which of these is NOT a good use of machine learning?",attempted:!1,answers:[{text:"Sentiment analysis - recognising the mood, tone or emotion in text",correct:!1},{text:"Translating text from one language to another",correct:!1},{text:"Face recognition - recognising a face in a photo and identifying who it is",correct:!1},{text:"Self-driving cars",correct:!1},{text:"Predicting if a credit card transaction is fraudulent",correct:!1},{text:"Calculating the current cost of a product in different countries based on exchange rates",correct:!0},{text:"Recommending a movie based on films you've watched before",correct:!1}],notes:["Tasks that involve following rules which can be worked out are not a good use for machine learning.","A computer isn't going to learn how to apply an exchange rate from examples - we can just tell it what to do."]},{question:"Which of these approaches would be more likely to be successful?",attempted:!1,answers:[{text:"Collect a small set of examples, train a system, test to see how good it is. Add more examples, train and test again. Repeat until it gets good enough.",correct:!0},{text:"More examples is better, so decide you must need millions. Start collecting a massive set of examples, and spend months collecting more and more and more.",correct:!1}],notes:["More examples is generally better, but be practical.","Pragmatism is important. Regular testing is useful to let you know how things are going, and when you've done enough.","When you've only got ten examples, another ten will probably make a huge difference.","When you've got 100,000 examples, another ten probably won't have a noticeable impact."]},{question:"Which of these statements is correct?",attempted:!1,answers:[{text:"Machine learning is a technique where computers can be trained to perform tasks instead of needing to be given an explicit set of steps to follow",correct:!0},{text:"Machine learning is magic",correct:!1},{text:"Machine learning means we don't need to think about problems any more because computers will think for us",correct:!1},{text:"Machine learning has replaced the need to learn how to code",correct:!1},{text:"Machine learning can only be done on massive supercomputers",correct:!1}]},{question:"A machine learning system trained to recognise pictures with a tree in should be effective at which of the following tasks:",attempted:!1,answers:[{text:"Identifying pictures of fruit",correct:!1},{text:"Recognising the emotion in a piece of writing",correct:!1},{text:"Recognising pictures of trees",correct:!0}],notes:["Machine learning does not mean computers magically learn to do everything.","It means they learn how to do a specific task by being shown examples of that specific task.","If you want it to do something else, you need to train it to do that as well, by giving it examples of that."]},{question:"Alice and Bob both want to train a machine learning system to recognise if text is happy/positive or sad/negative. Which of them will probably train the best system?",attempted:!1,answers:[{text:"Alice. She has collected 10 varied examples of happy text, and 10 varied examples of sad text",correct:!0},{text:"Bob. He has collected 1000 examples of happy writing and 20 examples of sad writing",correct:!1}],notes:["Collecting a roughly similar number of examples for each label is a useful technique.","If nearly every example of writing you train a system with is happy, you might end up training the system to assume that sad writing is very unlikely, and that it should assume happy more often.","","But, you might want it to do this.","If you're training a system to recognise text where it is happy 98% of the time, training it with that realistic experience might be worth a try."]},{question:"Advanced machine learning technology will always give correct answers. Incorrect answers mean the machine learning technology isn't very good",attempted:!1,answers:[{text:"True",correct:!1},{text:"False",correct:!0}],notes:["Not necessarily.","","The technology and algorithms are important. BUT machine learning systems are only as accurate and reliable as the training that they are given.","Simple machine learning algorithms with a lot of high quality training can do better than the most advanced machine learning algorithms with a small amount of poor quality training."]}];return{getQuestion:function(){if(0<r.length){var e=(n=r.length-1,Math.floor(Math.random()*(n+1))),t=r.splice(e,1)[0];return t.answers.forEach(function(e){e.selected=!1}),t}var n},restoreQuestion:function(e){e.attempted=!0,r.push(e)}}}angular.module("app").service("quizService",e),e.$inject=[]}(),function(){function e(e,t,r,n,a,o,s){var i=this;i.authService=e;var c=1;function l(e,t){t||(t={}),i[e].push({alertid:c++,message:t.message||t.error||"Unknown error",status:t.status})}i.errors=[],i.warnings=[],i.dismissAlert=function(e,t){i[e].splice(t,1)},a.projectId=n.projectId,a.userId=n.userId,a.scratchblocks={label:"",confidence:"",sample:""},e.getProfileDeferred().then(function(e){return i.profile=e,t.getProject(a.projectId,a.userId,e.tenant)}).then(function(e){return"numbers"===(a.project=e).type?t.getFields(a.projectId,a.userId,i.profile.tenant):void 0}).then(function(e){if(a.scratchblocks.label="recognise "+a.project.type+" ","text"===a.project.type)a.scratchblocks.label+="[text]";else if("images"===a.project.type)a.scratchblocks.label+="[costume image]";else if("numbers"===a.project.type){var t=1;for(var n in e){var r=e[n].name;a.scratchblocks.label+=r+" ("+t+++") "}}a.scratchblocks.confidence=a.scratchblocks.label+" \\(confidence) :: custom reporter",a.scratchblocks.label+=" \\(label) :: custom reporter","text"===a.project.type?a.scratchblocks.sample="ask [enter some text here] and wait \nif &lt;{recognise text (answer) \\(label) :: custom reporter } = ("+a.project.labels[0]+" :: custom reporter)&gt; then \nsay [I think that was "+a.project.labels[0]+"]":"images"===a.project.type?a.scratchblocks.sample="if &lt;{recognise images (costume image :: looks) :: custom reporter } = ("+a.project.labels[0]+" :: custom reporter)&gt; then \nsay [I think that is a picture of "+a.project.labels[0]+"]":"numbers"===a.project.type&&(a.scratchblocks.sample="if &lt;{"+a.scratchblocks.label+"} = ("+a.project.labels[0]+" :: custom reporter)&gt; then \nsay [I think that was "+a.project.labels[0]+"]"),s(function(){scratchblocks.renderMatching(".scratchblocks")},50)}).catch(function(e){l("errors",e.data)}),i.getScratchKey=function(e,t){var n=o.open("/scratchx/loading.html","_blank");r.getScratchKeys(t.id,a.userId,i.profile.tenant).then(function(e){var t=e[0];t.extensionurl=window.location.origin+"/api/scratch/"+t.id+"/extension.js",t.url="/scratchx?url="+t.extensionurl+"#scratch",t.model?n.location.href=t.url:n.close(),a.scratchkey=t}).catch(function(e){l("errors",e.data)})}}angular.module("app").controller("ScratchController",e),e.$inject=["authService","projectsService","scratchkeysService","$stateParams","$scope","$window","$timeout"]}(),function(){function e(e,r){return{getScratchKeys:function(e,t,n){return r.get("/api/classes/"+n+"/students/"+t+"/projects/"+e+"/scratchkeys").then(function(e){return e.data})}}}angular.module("app").service("scratchkeysService",e),e.$inject=["$q","$http"]}(),function(){function e(e,t,n,r){var a=this;a.authService=e,a.focused="";var o=1;function s(t){r(function(){var e=document.getElementById(t);n.duScrollToElementAnimated(angular.element(e))},0)}a.errors=[],a.infos=[],a.dismissAlert=function(e,t){a[e].splice(t,1)},a.creating=!1,a.complete=!1,a.confirm=function(e){a.creating=!0,t.createTeacher(e.username,e.email,e.intendeduse).then(function(e){console.log(e);var t=o++;a.infos.push({alertid:t,password:e.password}),s("infos"+t),a.complete=!0}).catch(function(e){a.creating=!1,function(e,t,n){n||(n={});var r=o++;a[e].push({alertid:r,message:n.message||n.error||"Unknown error",status:t}),s(e+r)}("errors",500,e.data)})}}angular.module("app").controller("SignupController",e),e.$inject=["authService","usersService","$document","$timeout"]}(),function(){function e(e,t,n,r){var a=this;a.authService=e;var o=1;function s(e,t,n){n||(n={});var r=o++;return a[e].push({alertid:r,message:n.message||n.error||"Unknown error",status:t}),r}a.errors=[],a.warnings=[],a.dismissAlert=function(e,t){a[e].splice(t,1)},e.getProfileDeferred().then(function(e){"supervisor"===(a.profile=e).role&&t.getClassPolicy(e).then(function(e){a.policy=e,a.policy.missingCredentials=!1;for(var t=0;t<e.supportedProjectTypes.length;t++){var n=e.supportedProjectTypes[t];("text"===n&&0===e.maxTextModels||"images"===n&&0===e.maxImageModels)&&(a.policy.missingCredentials=!0)}}).catch(function(e){s("errors",e.status,e.data)})}).catch(function(e){s("errors",e.status,e.data)})}angular.module("app").controller("TeacherController",e),e.$inject=["authService","usersService","$document","$timeout"]}(),function(){function e(e,a,n,o,r,s){var i=this;i.authService=e;var c=1;function l(e,t,n){n||(n={});var r=c++;return i[e].push({alertid:r,message:n.message||n.error||"Unknown error",status:t}),r}function u(e,t){a.getCredentials(e,t).then(function(e){i.credentials[t]=e,i.credentials.loading[t]=!1}).catch(function(e){i.credentials.failed[t]=!0,i.credentials.loading[t]=!1,l("errors",e.status,e.data)})}i.errors=[],i.warnings=[],i.dismissAlert=function(e,t){i[e].splice(t,1)},e.getProfileDeferred().then(function(n){"supervisor"===(i.profile=n).role&&a.getClassPolicy(n).then(function(e){var t;i.policy=e,!1===i.policy.isManaged&&(t=n,i.credentials={loading:{visrec:!0,conv:!0},failed:{visrec:!1,conv:!1}},u(t,"visrec"),u(t,"conv"))}).catch(function(e){l("errors",e.status,e.data)})}).catch(function(e){l("errors",e.status,e.data)}),i.deleteCredentials=function(e,t,n){var r=o.confirm().title("Are you sure?").textContent("Do you want to remove these credentials from machinelearningforkids.co.uk?").ariaLabel("Confirm").targetEvent(e).ok("Yes").cancel("No");o.show(r).then(function(){a.deleteCredentials(i.profile,t).then(function(){i.credentials[n]=i.credentials[n].filter(function(e){return e.id!==t.id})}).catch(function(e){l("errors",e.status,e.data)})},function(){})},i.addCredentials=function(e,t){o.show({controller:["$scope","$mdDialog",function(e,t){e.type="password",e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.confirm=function(e){t.hide(e)}}],templateUrl:"static/components-"+n.VERSION+"/teacher_apikeys/newcreds"+t+".tmpl.html",targetEvent:e,clickOutsideToClose:!0}).then(function(e){e.servicetype=t,a.addCredentials(e,i.profile.tenant).then(function(e){i.credentials[t].push(e)}).catch(function(e){var t,n=l("errors",e.status,e.data);t="errors"+n,s(function(){var e=document.getElementById(t);r.duScrollToElementAnimated(angular.element(e))},0)})},function(){})}}angular.module("app").controller("TeacherApiKeysController",e),e.$inject=["authService","usersService","$stateParams","$mdDialog","$document","$timeout"]}(),function(){function e(e,t,n,r){var a=this;a.authService=e;var o=1;function s(e,t,n){n||(n={});var r=o++;return a[e].push({alertid:r,message:n.message||n.error||"Unknown error",status:t}),r}a.errors=[],a.warnings=[],a.dismissAlert=function(e,t){a[e].splice(t,1)},e.getProfileDeferred().then(function(e){"supervisor"===(a.profile=e).role&&t.getClassPolicy(e).then(function(e){a.policy=e}).catch(function(e){s("errors",e.status,e.data)})}).catch(function(e){s("errors",e.status,e.data)})}angular.module("app").controller("TeacherRestrictionsController",e),e.$inject=["authService","usersService","$document","$timeout"]}(),function(){function e(e,a,n,r,o,s){var i=this;i.authService=e;var c=1,l=1;function u(e,t,n){n||(n={});var r=l++;return i[e].push({alertid:r,message:n.message||n.error||"Unknown error",status:t}),r}function d(e,t){r.show(r.alert().clickOutsideToClose(!0).title(t.username).htmlContent('Password: <span class="passworddisplaydialog">'+t.password+"</span>").ariaLabel("Confirm student password").ok("OK").targetEvent(e))}i.errors=[],i.warnings=[],i.dismissAlert=function(e,t){i[e].splice(t,1)},e.getProfileDeferred().then(function(e){var t;"supervisor"===(i.profile=e).role&&(t=e,a.getStudentList(t).then(function(e){i.students=e}).catch(function(e){u("errors",e.status,e.data)}),a.getClassPolicy(e).then(function(e){i.policy=e}).catch(function(e){u("errors",e.status,e.data)}))}).catch(function(e){u("errors",e.status,e.data)}),i.deleteUser=function(e,t){var n=r.confirm().title("Are you sure?").textContent("Do you want to delete "+t.username+" and all of their work? (This cannot be undone)").ariaLabel("Confirm").targetEvent(e).ok("Yes").cancel("No");r.show(n).then(function(){t.isPlaceholder=!0,a.deleteStudent(t,i.profile.tenant).then(function(){i.students=i.students.filter(function(e){return e.username!==t.username})}).catch(function(e){t.isPlaceholder=!1,u("errors",e.status,e.data)})},function(){})},i.createUser=function(t){r.show({controller:["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.confirm=function(e){t.hide(e)}}],templateUrl:"static/components-"+n.VERSION+"/teacher_students/newstudent.tmpl.html",targetEvent:t,clickOutsideToClose:!0}).then(function(e){var r={id:c++,username:e,isPlaceholder:!0};i.students.push(r),a.createStudent(e,i.profile.tenant).then(function(e){r.id=e.id,r.isPlaceholder=!1,d(t,e)}).catch(function(e){var t,n=u("errors",e.status,e.data);t="errors"+n,s(function(){var e=document.getElementById(t);o.duScrollToElementAnimated(angular.element(e))},0),i.students=i.students.filter(function(e){return e.id!==r.id})})},function(){})},i.resetUserPassword=function(t,n){n.isPlaceholder=!0,a.resetStudentPassword(n,i.profile.tenant).then(function(e){n.isPlaceholder=!1,d(t,e)}).catch(function(e){n.isPlaceholder=!1,u("errors",e.status,e.data)})},i.resetUsersPassword=function(t){var e=r.confirm().title("Are you sure?").textContent("Do you want to reset the passwords for all your students (so they all have the same password)?").ariaLabel("Confirm").targetEvent(t).ok("Yes").cancel("No");r.show(e).then(function(){i.students.forEach(function(e){e.isPlaceholder=!0}),a.resetStudentsPassword(i.students,i.profile.tenant).then(function(e){i.students.forEach(function(e){e.isPlaceholder=!1}),d(t,{username:"All students",password:e[0].password})}).catch(function(e){i.students.forEach(function(e){e.isPlaceholder=!1}),u("errors",e.status,e.data)})},function(){})}}angular.module("app").controller("TeacherStudentsController",e),e.$inject=["authService","usersService","$stateParams","$mdDialog","$document","$timeout"]}(),function(){function e(e,t,r,a,n,o,s,i,c){var l=this;l.authService=e;c.submittingDeleteRequest=!1;var u=1;function d(e,t,n){n||(n={});var r=u++;return l[e].push({alertid:r,message:n.message||n.error||"Unknown error",status:t}),r}l.errors=[],l.warnings=[],l.dismissAlert=function(e,t){l[e].splice(t,1)},l.orderBy="name",e.getProfileDeferred().then(function(e){var t,n;"supervisor"===(l.profile=e).role&&(n=e,r.getClassProjects(n).then(function(e){l.projects=e;for(var t=0;t<l.projects.length;t++){var n=l.projects[t];if(0<n.labels.length){var r="";switch(n.labels.length){case 1:r=n.labels[0];break;case 2:r=n.labels[0]+" or "+n.labels[1];break;case 3:r=n.labels[0]+", "+n.labels[1]+" or "+n.labels[2];break;default:r=n.labels[0]+", "+n.labels[1]+" or "+(n.labels.length-2)+" other classes"}n.labelsSummary=r}}}).catch(function(e){d("errors",e.status,e.data)}),t=e,a.getUnmanagedClassifiers(t.tenant).then(function(e){l.classifiers=e}).catch(function(e){e&&e.status&&403===e.status||console.log(e)}))}).catch(function(e){d("errors",e.status,e.data)}),l.deleteModel=function(e,t){var n=o.confirm().title("Are you sure?").textContent("Do you want to delete "+(t.owner?t.owner.username+"'s ":"")+"machine learning model from project "+t.name+"?").ariaLabel("Confirm").targetEvent(e).ok("Yes").cancel("No");o.show(n).then(function(){t.hasModel=!1,a.deleteModel(t.id,t.userid,t.classid,t.classifierId).then(function(){console.log("deletion successful")}).catch(function(e){d("errors",e.status,e.data)})},function(){})},l.deleteClassifier=function(e,t){c.submittingDeleteRequest=!0;var n=o.confirm().title("Are you sure?").textContent("Do you want to delete "+t.name+"?").ariaLabel("Confirm").targetEvent(e).ok("Yes").cancel("No");o.show(n).then(function(){a.deleteBluemixClassifier(l.profile.tenant,t.id,t.credentials.id,t.type).then(function(){c.submittingDeleteRequest=!1,l.classifiers[t.type]=l.classifiers[t.type].filter(function(e){return e.id!==t.id})}).catch(function(e){c.submittingDeleteRequest=!1,d("errors",e.status,e.data)})},function(){})}}angular.module("app").controller("TeacherProjectsController",e),e.$inject=["authService","usersService","projectsService","trainingService","$stateParams","$mdDialog","$document","$timeout","$scope"]}(),angular.module("app").directive("httpSrc",["$http",function(r){return{link:function(e,t,c){var n={method:"Get",url:c.httpSrc,responseType:"arraybuffer",cache:"true"};r(n).then(function(e){var t,n,r,a=e.headers("content-type"),o=new Uint8Array(e.data),s="";for(t=0,n=o.length;t<n;t+=5e3)r=o.subarray(t,t+5e3),s+=String.fromCharCode.apply(null,r);var i=btoa(s);c.$set("src","data:"+a+";base64,"+i)})},restrict:"A"}}]),angular.module("app").directive("mlImageLoader",function(){function s(e){return e&&e.preventDefault&&e.preventDefault(),e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),!1}var f=/^https:\/\/www\.google\.co[a-z.]+\/imgres\?(imgurl=.*)/;function g(e,t){return e&&e.indexOf&&-1!==e.indexOf(t)?t:"Text"}function i(e,t,n){if(!e.dataTransfer)return!1;if(e.preventDefault&&e.preventDefault(),e.dataTransfer.files&&0<e.dataTransfer.files.length)return n.getController().displayAlert("warnings",400,{message:"You can't upload pictures from your computer. Use pictures that are already online, by dragging them from another web page"}),n.$apply(),!1;var r,a,o,i;if(e.dataTransfer.types&&0<e.dataTransfer.types.length){var s=g(e.dataTransfer.types,"text/uri-list"),c=e.dataTransfer.getData(s),l=c.match(f);if(l){var u=l[1],d=(i={},u.split("&").forEach(function(e){if(e){var t=(e=e.split("+").join(" ")).indexOf("="),n=-1<t?e.substr(0,t):e,r=-1<t?decodeURIComponent(e.substr(t+1)):"",a=n.indexOf("[");if(-1===a)i[decodeURIComponent(n)]=r;else{var o=n.indexOf("]",a),s=decodeURIComponent(n.substring(a+1,o));n=decodeURIComponent(n.substring(0,a)),i[n]||(i[n]=[]),s?i[n][s]=r:i[n].push(r)}}}),i);r=d.imgurl}else{var s=g(e.dataTransfer.types,"text/html"),h=e.dataTransfer.getData(s),p=(a=h,(o=document.implementation.createHTMLDocument("title")).body.innerHTML=a,o),m=p.querySelector("img");m&&(r=m.src)}}else r=e.dataTransfer.getData("Text");return r?n.getController().addConfirmedTrainingData(r,t):n.getController().displayAlert("warnings",400,{message:0<=navigator.userAgent.indexOf("Safari")?'Dragging pictures does not work in Safari. Use a different browser, or use the "www" button instead.':"Drag a picture from another web page into one of the training buckets"}),n.$apply(),!1}return{link:function(t,n,e){var r=n[0],a=t.$parent.label;r.addEventListener("dragover",s);var o=0;r.addEventListener("dragleave",function(e){return 0==(o-=1)&&angular.element(e.target).removeClass("hover"),s(e)}),r.addEventListener("dragenter",function(e){return o+=1,angular.element(e.target).addClass("hover"),s(e)}),r.addEventListener("drop",function(e){if(e&&e.dataTransfer)return o=0,angular.element(e.target).removeClass("hover"),n.removeClass("hover"),angular.element(document.querySelector(".trainingbucketitems.hover")).removeClass("hover"),i(e,a,t)})}}}),angular.module("app").directive("mlImageOnError",function(){return{link:function(e,t,n){t.bind("error",function(){e.$apply(n.mlImageOnError)})}}}),function(){function e(e,a,s,n,i,o,t,c,l){var u=this;u.authService=e;var d=1,r=1;function h(e,t,n){n||(n={}),u[e].push({alertid:r++,message:n.message||n.error||"Unknown error",status:t})}function p(){var e="";if(0<i.project.labels.length)switch(i.project.labels.length){case 1:e=i.project.labels[0];break;case 2:e=i.project.labels[0]+" or "+i.project.labels[1];break;case 3:e=i.project.labels[0]+", "+i.project.labels[1]+" or "+i.project.labels[2];break;default:e=i.project.labels[0]+", "+i.project.labels[1]+" or "+(i.project.labels.length-2)+" other classes"}i.project.labelsSummary=e}function m(n){c(function(){var e=document.getElementById(n),t=e.parentElement;angular.element(t).duScrollToElementAnimated(angular.element(e))},0)}function f(e,t){for(var n=i.training[e].length,r=0;r<n;r++)if(i.training[e][r].id===t)return r;return-1}u.errors=[],u.warnings=[],u.dismissAlert=function(e,t){u[e].splice(t,1)},u.displayAlert=h,i.loadingtraining=!0,i.crowdSourced=!1,i.projectId=n.projectId,i.userId=n.userId,i.training={},e.getProfileDeferred().then(function(e){return u.profile=e,a.getProject(i.projectId,i.userId,e.tenant)}).then(function(e){if(i.project=e,i.crowdSourced=e.isCrowdSourced&&u.profile.user_id!==e.userid,"numbers"===e.type)return a.getFields(i.projectId,i.userId,u.profile.tenant)}).then(function(e){for(var t in i.project.fields=e,p(),i.project.labels){var n=i.project.labels[t];i.training[n]=[]}return s.getTraining(i.projectId,i.userId,u.profile.tenant)}).then(function(e){for(var t in i.loadingtraining=!1,e){var n=e[t],r=n.label;r in i.training==!1&&(i.training[r]=[]),i.training[r].push(n)}}).catch(function(e){h("errors",e.status,e.data)}),u.addTrainingData=function(e,t){o.show({locals:{label:t,project:i.project},controller:["$scope","locals",function(e,t){e.label=t.label,e.project=t.project,e.values={},e.hide=function(){o.hide()},e.cancel=function(){o.cancel()},e.confirm=function(e){o.hide(e)}}],templateUrl:"static/components-"+n.VERSION+"/training/trainingdata.tmpl.html",targetEvent:e,clickOutsideToClose:!0}).then(function(e){u.addConfirmedTrainingData(e,t)},function(){})},u.addConfirmedTrainingData=function(e,n){var t,r,a,o=!1;if("text"===i.project.type?(t=e,o=i.training[n].some(function(e){return e.textdata===t}),r={id:d++,label:n,projectid:i.projectId,textdata:t,isPlaceholder:!0}):"numbers"===i.project.type?(a=e,t=Object.keys(a).map(function(e){return a[e]}),r={id:d++,label:n,projectid:i.projectId,numberdata:t,isPlaceholder:!0}):"images"===i.project.type&&(t=e,o=i.training[n].some(function(e){return e.imageurl===t}),r={id:d++,label:n,projectid:i.projectId,imageurl:t,isPlaceholder:!0}),o)return h("errors",400,{message:"That is already in your training data"});i.training[n].push(r),s.newTrainingData(i.projectId,i.userId,u.profile.tenant,t,n).then(function(e){r.isPlaceholder=!1,r.id=e.id,m(e.id)}).catch(function(e){h("errors",e.status,e.data);var t=f(n,r.id);-1!==t&&i.training[n].splice(t,1)})},u.onImageLoad=function(e){console.log(e),console.log("on image load")},u.onImageError=function(e){e.loadingFailed=!0},u.addLabel=function(e,t){o.show({controller:["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.confirm=function(e){t.hide(e)}}],templateUrl:"static/components-"+n.VERSION+"/training/newlabel.tmpl.html",targetEvent:e,clickOutsideToClose:!0}).then(function(e){a.addLabelToProject(i.projectId,i.userId,u.profile.tenant,e).then(function(e){i.project.labels=e;for(var t=0;t<e.length;t++)i.training[e[t]]||(i.training[e[t]]=[]);p()}).catch(function(e){h("errors",e.status,e.data)})},function(){})},u.deleteText=function(e,t,n){i.training[e].splice(n,1),s.deleteTrainingData(i.projectId,i.userId,u.profile.tenant,t.id)},u.deleteLabel=function(e,t,n){var r=o.confirm().title("Are you sure?").textContent('Do you want to delete "'+t+'"? (This cannot be undone)').ariaLabel("Confirm").targetEvent(e).ok("Yes").cancel("No");o.show(r).then(function(){delete i.training[t],i.project.labels.splice(n,1),p(),a.removeLabelFromProject(i.projectId,i.userId,u.profile.tenant,t).catch(function(e){h("errors",e.status,e.data)})},function(){})},u.useWebcam=function(e,r){o.show({locals:{label:r,project:i.project},controller:["$scope","locals",function(r,e){function n(e){(r.webcamerror=e)&&e.message&&("NotAllowedError"===e.name?r.webcamerrordetail="Not allowed to use the web-cam":r.webcamerrordetail=e.message)}r.label=e.label,r.project=e.project,r.values={},r.channel={},r.webcamerror=!1,r.webcamInitComplete=!1,r.webcamCanvas=null,r.hide=function(){o.hide()},r.cancel=function(){o.cancel()},r.confirm=function(){var n;(n=document.createElement("canvas"),n.width=r.channel.video.width,n.height=r.channel.video.height,n.getContext("2d").drawImage(r.channel.video,0,0,r.channel.video.width,r.channel.video.height),l(function(t,e){n.toBlob(function(e){t(e)},"image/jpeg")})).then(function(e){o.hide(e)})},r.onWebcamSuccess=function(){r.$apply(function(){r.webcamInitComplete=!0})},r.onWebcamError=function(t){r.webcamInitComplete=!0;try{r.$apply(function(){n(t)})}catch(e){c(function(){n(t)},0,!1)}}}],templateUrl:"static/components-"+n.VERSION+"/training/webcam.tmpl.html",targetEvent:e,clickOutsideToClose:!0}).then(function(e){var n={id:d++,label:r,projectid:i.projectId,imageurl:URL.createObjectURL(e),isPlaceholder:!0};i.training[r].push(n),s.uploadImage(i.project.id,i.userId,u.profile.tenant,e,r).then(function(e){n.isPlaceholder=!1,n.id=e.id,m(e.id)}).catch(function(e){h("errors",e.status,e.data);var t=f(r,n.id);-1!==t&&i.training[r].splice(t,1)})},function(){})},u.useCanvas=function(e,r){o.show({locals:{label:r,project:i.project},controller:["$scope","locals",function(n,e){n.label=e.label,n.project=e.project,n.values={},n.hide=function(){o.hide()},n.cancel=function(){o.cancel()},n.confirm=function(){l(function(t,e){n.canvas.toBlob(function(e){t(e)},"image/jpeg")}).then(function(e){o.hide(e)})}}],templateUrl:"static/components-"+n.VERSION+"/training/canvas.tmpl.html",targetEvent:e,clickOutsideToClose:!0}).then(function(e){var n={id:d++,label:r,projectid:i.projectId,imageurl:URL.createObjectURL(e),isPlaceholder:!0};i.training[r].push(n),s.uploadImage(i.project.id,i.userId,u.profile.tenant,e,r).then(function(e){n.isPlaceholder=!1,n.id=e.id,m(e.id)}).catch(function(e){h("errors",e.status,e.data);var t=f(r,n.id);-1!==t&&i.training[r].splice(t,1)})},function(){})},i.getController=function(){return u}}angular.module("app").controller("TrainingController",e),e.$inject=["authService","projectsService","trainingService","$stateParams","$scope","$mdDialog","$document","$timeout","$q"]}(),function(){function e(e,c){return{newTrainingData:function(e,t,n,r,a){var o="/api/classes/"+n+"/students/"+t+"/projects/"+e+"/training";return c.post(o,{data:r,label:a}).then(function(e){return e.data})},uploadImage:function(e,t,n,r,a){var o="/api/classes/"+n+"/students/"+t+"/projects/"+e+"/images",s=new FormData;s.append("image",r,"webcam.jpg"),s.append("label",a);var i={transformRequest:angular.identity,headers:{"Content-Type":void 0}};return c.post(o,s,i).then(function(e){return e.data})},getTraining:function(e,t,n){var r="/api/classes/"+n+"/students/"+t+"/projects/"+e+"/training";return c.get(r,{headers:{Range:"items=0-3000"}}).then(function(e){return e.data})},deleteTrainingData:function(e,t,n,r){var a="/api/classes/"+n+"/students/"+t+"/projects/"+e+"/training/"+r;return c.delete(a)},getModels:function(e,t,n){var r="/api/classes/"+n+"/students/"+t+"/projects/"+e+"/models";return c.get(r).then(function(e){return e.data})},newModel:function(e,t,n){var r="/api/classes/"+n+"/students/"+t+"/projects/"+e+"/models";return c.post(r,{},{timeout:18e4}).then(function(e){return e.data})},testModel:function(e,t,n,r,a,o,s){var i="/api/classes/"+r+"/students/"+n+"/projects/"+e+"/models/"+a+"/label";return s.credentialsid=o,c.post(i,s).then(function(e){return e.data})},deleteModel:function(e,t,n,r){var a="/api/classes/"+n+"/students/"+t+"/projects/"+e+"/models/"+r;return c.delete(a)},getUnmanagedClassifiers:function(e){var t="/api/classes/"+e+"/classifiers";return c.get(t,{params:{type:"unmanaged"}}).then(function(e){return e.data})},deleteBluemixClassifier:function(e,t,n,r){var a="/api/classes/"+e+"/classifiers/"+t;return c.delete(a,{params:{type:r,credentialsid:n}})}}}angular.module("app").service("trainingService",e),e.$inject=["$q","$http"]}(),function(){function e(e,a){return{createTeacher:function(e,t,n){var r={username:e,email:t,notes:n};return a.post("/api/teachers",r).then(function(e){return e.data})},getClassesList:function(){return a.get("/api/classes").then(function(e){return e.data})},addCredentials:function(e,t){return a.post("/api/classes/"+t+"/credentials",e).then(function(e){return e.data})},getCredentials:function(e,t){return a.get("/api/classes/"+e.tenant+"/credentials?servicetype="+t).then(function(e){return e.data})},deleteCredentials:function(e,t){return a.delete("/api/classes/"+e.tenant+"/credentials/"+t.id)},getClassPolicy:function(e){return a.get("/api/classes/"+e.tenant+"/policy").then(function(e){return e.data})},getStudentList:function(e){return a.get("/api/classes/"+e.tenant+"/students").then(function(e){return e.data})},createStudent:function(e,t){var n={username:e};return a.post("/api/classes/"+t+"/students",n).then(function(e){return e.data})},deleteStudent:function(e,t){return a.delete("/api/classes/"+t+"/students/"+e.id)},resetStudentPassword:function(e,t){return a.post("/api/classes/"+t+"/students/"+e.id+"/password").then(function(e){return e.data})},resetStudentsPassword:function(e,t){var n=e.map(function(e){return{op:"replace",path:"/password",value:{id:e.id}}});return a.patch("/api/classes/"+t+"/students",n).then(function(e){return e.data})}}}angular.module("app").service("usersService",e),e.$inject=["$q","$http"]}(),function(){function e(n,r,a){this.worksheets=[{title:"Smart classroom",summary:"Teach a computer to recognise the meaning of your commands",description:"Create a smart assistant in Scratch that lets you control virtual devices.",difficulty:"Beginner",type:"text",image:"static/images/project-smartclassroom.png",tags:["digital assistants","supervised learning"],teachersnotes:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/teachersnotes-smartclassroom.pdf",downloads:[{description:"Full version of the project, where the students make a non-machine learning version first to experience the value of using machine learning to do this",worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-smartclassroom.pdf"},{description:"Shorter version of the project, where the students only make a machine learning version of the assistant",worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-smartclassroom-easy.pdf"}]},{title:"Make me happy",summary:"Teach a computer to recognise compliments and insults",description:"Create a character in Scratch that smiles if you say nice things to it and cries if you say mean things to it.",difficulty:"Beginner",type:"text",image:"static/images/project-makemehappy.png",tags:["sentiment analysis","supervised learning"],teachersnotes:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/teachersnotes-makemehappy.pdf",downloads:[{worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-makemehappy.pdf"}]},{title:"Snap!",summary:"Teach a computer to recognise what icons look like",description:"Make a card game in Scratch that learns to recognise pictures of your card.",difficulty:"Beginner",type:"images",image:"static/images/project-snap.png",tags:["image classification","supervised learning"],teachersnotes:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/teachersnotes-snap.pdf",downloads:[{description:"Full version of the project, where the students make their own cards that they will train the computer to recognise",worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-snap.pdf"},{description:"Shorter version of the project, providing children with pre-made cards that you will need to print out, to save the students time having to make them",worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-snap-easy.pdf",resources:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/resources-snap-easy.pdf"}]},{title:"Mailman Max",summary:"Teach a computer to recognise handwriting",description:"Make a postal sorting office in Scratch that can recognise handwritten postcodes on envelopes.",difficulty:"Beginner",type:"images",image:"static/images/project-mailmanmax.png",tags:["optical character recognition","handwriting recognition","image classification","supervised learning"],teachersnotes:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/teachersnotes-mailmanmax.pdf",downloads:[{worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-mailmanmax.pdf"}]},{title:"Car or cup",summary:"Teach a computer to recognise pictures of objects",description:"Train the computer to be able to sort photos into groups.",difficulty:"Beginner",type:"images",image:"static/images/project-carorcup.png",tags:["image classification","supervised learning","crowd sourcing"],teachersnotes:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/teachersnotes-carorcup.pdf",downloads:[{description:"Individual version of the project, where each student trains their own machine learning model independently",worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-carorcup.pdf"},{description:"Group version of the project, where all students in the class work together to train a shared machine learning model",worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-carorcup-crowd.pdf"}]},{title:"Face Lock",summary:"Teach a computer to recognise faces",description:"Make a phone in Scratch that unlocks if it recognises your face.",difficulty:"Beginner",type:"images",image:"static/images/project-facelock.png",tags:["facial recognition","biometrics","image classification","supervised learning"],teachersnotes:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/teachersnotes-facelock.pdf",downloads:[{worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-facelock.pdf"}]},{title:"Journey to school",summary:"Teach a computer to make predictions",description:"Train the computer to be able to predict how you travel to school in the morning.",difficulty:"Beginner",type:"numbers",image:"static/images/project-journeytoschool.png",tags:["predictive model","testing and accuracy","supervised learning"],teachersnotes:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/teachersnotes-journeytoschool.pdf",downloads:[{worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-journeytoschool.pdf"}]},{title:"Pac-Man",summary:"Teach a computer to play a game",description:"Create a Pac-Man game in Scratch that learns how to avoid the ghost.",difficulty:"Intermediate",type:"numbers",image:"static/images/project-pacman.png",tags:["decision tree learning"],teachersnotes:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/teachersnotes-pacman.pdf",downloads:[{worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-pacman.pdf"}]},{title:"Chatbots",summary:"Teach a computer to recognise questions",description:"Create a chatbot that can answer questions about a topic of your choice.",difficulty:"Intermediate",type:"text",image:"static/images/project-chatbots.png",tags:["sentiment analysis","supervised learning"],teachersnotes:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/teachersnotes-chatbots.pdf",downloads:[{worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-chatbots.pdf"}]},{title:"Tourist Info",summary:"Teach a computer to make recommendations",description:"Create a mobile app in Scratch that recommends tourist attractions based on people's interests.",difficulty:"Intermediate",type:"text",image:"static/images/project-touristinfo.png",tags:["training bias","recommendations","supervised learning"],teachersnotes:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/teachersnotes-touristinfo.pdf",downloads:[{description:"Full version of the project",worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-touristinfo.pdf"},{description:"Shorter version of the project, where students make less of the Scratch project themselves, with more of the scripting provided in the starter project file",worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-touristinfo-easy.pdf"}]},{title:"Sorting Hat",summary:"Teach a computer to recognise use of language",description:"Create a Sorting Hat like in Harry Potter, that puts you in a school House based on what you say.",difficulty:"Intermediate",type:"text",image:"static/images/project-sortinghat.png",tags:["text classification","supervised learning","crowd sourcing"],teachersnotes:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/teachersnotes-sortinghat.pdf",downloads:[{description:"Individual version of the project, where each student trains their own machine learning model independently",worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-sortinghat.pdf"},{description:"Group version of the project, where all students in the class work together to train a shared machine learning model",worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-sortinghat-crowd.pdf"}]},{title:"Rock, Paper, Scissors",summary:"Teach a computer to recognise shapes",description:"Make a Rock, Paper, Scissors game in Scratch that learns to recognise hand shapes.",difficulty:"Intermediate",type:"images",image:"static/images/project-rockpaperscissors.png",tags:["image classification","supervised learning"],teachersnotes:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/teachersnotes-rockpaperscissors.pdf",downloads:[{worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-rockpaperscissors.pdf"}]},{title:"Judge a book",summary:"Teach a computer to recognise visual style",description:"Make a game in Scratch to test whether it really is possible to judge a book by its cover.",difficulty:"Intermediate",type:"images",image:"static/images/project-judgeabook.png",tags:["image classification","supervised learning"],teachersnotes:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/teachersnotes-judgeabook.pdf",downloads:[{worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-judgeabook.pdf"}]},{title:"Locate Larry",summary:"Teach a computer to find something in a picture",description:'Make a "Where\'s Wally?"-style game in Scratch, and teach the computer to find your character.',difficulty:"Intermediate",type:"images",image:"static/images/project-locatelarry.png",tags:["image classification","supervised learning","image pre-processing"],teachersnotes:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/teachersnotes-locatelarry.pdf",downloads:[{worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-locatelarry.pdf"}]},{title:"Confused",summary:"Teach a computer to recognise fruit",description:"Learn about how computers can be confused and can make mistakes if they're trained badly.",difficulty:"Intermediate",type:"images",image:"static/images/project-confused.png",tags:["image classification","supervised learning","overfitting"],teachersnotes:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/teachersnotes-confused.pdf",downloads:[{worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-confused.pdf"}]},{title:"School Library",summary:"Teach a computer to make recommendations",description:"Create a school librarian in Scratch that suggests who a reading book might be suitable for.",difficulty:"Intermediate",type:"numbers",image:"static/images/project-schoollibrary.png",tags:["predictive model","recommendations","supervised learning"],teachersnotes:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/teachersnotes-schoollibrary.pdf",downloads:[{worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-schoollibrary.pdf"}]},{title:"Noughts & Crosses",summary:"Teach a computer to play a game",description:"Create a noughts and crosses game in Scratch that learns how to beat you.",difficulty:"Advanced",type:"numbers",image:"static/images/project-noughtsandcrosses.png",tags:["decision tree learning","reinforcement learning","categorical data"],teachersnotes:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/teachersnotes-noughtsandcrosses.pdf",downloads:[{description:"Classroom version, where each student makes the game themselves",worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-noughtsandcrosses.pdf"},{description:"Demo version, for events like Science Fairs where each child has a minute or two to try something",worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-noughtsandcrosses-event.pdf"}]},{title:"Top Trumps",summary:"Teach a computer to play a game",description:"Train a computer to be able to play the Top Trumps card game in Scratch.",difficulty:"Advanced",type:"numbers",image:"static/images/project-toptrumps.png",tags:["decision tree learning","reinforcement learning","categorical data"],teachersnotes:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/teachersnotes-toptrumps.pdf",downloads:[{worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-toptrumps.pdf"}]},{title:"Headlines",summary:"Test the computer's ability to recognise use of language",description:"Train a computer to recognise headlines from national newspapers.",difficulty:"Advanced",type:"text",image:"static/images/project-headlines.png",tags:["text classification","supervised learning","testing"],teachersnotes:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/teachersnotes-headlines.pdf",downloads:[{description:"Simplified version of the project, where students make a simple project to put newspapers on the right shelves",worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-headlines-easy.pdf"},{description:"Advanced version of the project, where students make a testing framework to analyse the performance of their model",worksheet:"https://github.com/dalelane/ml-for-kids/raw/master/worksheets/worksheet-headlines.pdf"}]}],this.downloadWorksheet=function(e,t){r.show({locals:{worksheet:t},controller:["$scope","locals",function(e,t){e.worksheet=t.worksheet,e.hide=function(){r.hide()},e.cancel=function(){r.cancel()}}],templateUrl:"static/components-"+n.VERSION+"/worksheets/download.tmpl.html",targetEvent:e,clickOutsideToClose:!0})},a.projecttype="ALL",a.projectdifficulty="ALL",a.filterWorksheets=function(e){var t=!0;return"ALL"!==a.projecttype&&t&&(t=e.type===a.projecttype),"ALL"!=a.projectdifficulty&&t&&(t=e.difficulty===a.projectdifficulty),t}}angular.module("app").controller("WorksheetsController",e),e.$inject=["$stateParams","$mdDialog","$scope"]}();
//# sourceMappingURL=mlapp-1530056054415.min.js.map
